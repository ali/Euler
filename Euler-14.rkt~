;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-advanced-reader.ss" "lang")((modname Euler-14) (read-case-sensitive #t) (teachpacks ()) (htdp-settings #(#t constructor repeating-decimal #t #t none #f ())))
(define (f n)
  (cond
    [(even? n) (/ n 2)]
    [else (+ (* 3 n) 1)]))
(check-expect (f 13) 40)
(check-expect (f 40) 20)
(check-expect (f 5) 16)

(define (chain i)
  (local [(define (loop i lst)
  (cond
    [(= i 1) (append lst '(1))]
    [else (loop (f i)
                 (append lst (list i)))]))]
    (loop i empty)))
(check-expect (chain 13) '(13 40 20 10 5 16 8 4 2 1))

(define (Euler lst)
  (cond
    [(empty? lst) 0]
    [(cons? lst) (max (length (chain (first lst)))
                      (Euler (rest lst)))]))

;(Euler (rest (build-list 1000000 identity)))